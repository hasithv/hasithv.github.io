<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>6.1 - The Diffusion Limit of Random Walks | HasithAlted</title>
<meta name="keywords" content="stochastics, lecture">
<meta name="description" content="Random Walk
Let $\{\xi_i\}$ be i.i.d. random variables such that $\xi_i = \pm 1$ with probability $1/2$. Then, define

$$X_n = \sum_{k=1}^{n} \xi_k, \quad X_0 = 0.$$
$\{X_n\}$ is the familiar symmetric random walk on $\mathbb{Z}$. Let $W(m,n) = \mathbb{P}(X_N = m)$. It is easy to see that

$$W(m,n) = {N \choose (N&#43;m)/2} \left( \frac{1}{2} \right)^N$$
and that the mean and std are

$$\mathbb{E}[X_N] = 0, \quad \sigma^2_{X_N} = N$$Diffusion Coefficient

Definition 6.2: (Diffusion coefficient). The diffusion coefficient $D$ is defined as
">
<meta name="author" content="Hasith Vattikuti">
<link rel="canonical" href="https://hasithv.github.io/posts/eliasa/chap6/6-1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://hasithv.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://hasithv.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hasithv.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://hasithv.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://hasithv.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://hasithv.github.io/posts/eliasa/chap6/6-1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><script src="https://cdn.plot.ly/plotly-2.20.0.min.js"></script><meta property="og:url" content="https://hasithv.github.io/posts/eliasa/chap6/6-1/">
  <meta property="og:site_name" content="HasithAlted">
  <meta property="og:title" content="6.1 - The Diffusion Limit of Random Walks">
  <meta property="og:description" content="Random Walk Let $\{\xi_i\}$ be i.i.d. random variables such that $\xi_i = \pm 1$ with probability $1/2$. Then, define $$X_n = \sum_{k=1}^{n} \xi_k, \quad X_0 = 0.$$ $\{X_n\}$ is the familiar symmetric random walk on $\mathbb{Z}$. Let $W(m,n) = \mathbb{P}(X_N = m)$. It is easy to see that $$W(m,n) = {N \choose (N&#43;m)/2} \left( \frac{1}{2} \right)^N$$ and that the mean and std are $$\mathbb{E}[X_N] = 0, \quad \sigma^2_{X_N} = N$$Diffusion Coefficient Definition 6.2: (Diffusion coefficient). The diffusion coefficient $D$ is defined as ">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-10T15:41:44-07:00">
    <meta property="article:modified_time" content="2024-08-10T15:41:44-07:00">
    <meta property="article:tag" content="Stochastics">
    <meta property="article:tag" content="Lecture">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6.1 - The Diffusion Limit of Random Walks">
<meta name="twitter:description" content="Random Walk
Let $\{\xi_i\}$ be i.i.d. random variables such that $\xi_i = \pm 1$ with probability $1/2$. Then, define

$$X_n = \sum_{k=1}^{n} \xi_k, \quad X_0 = 0.$$
$\{X_n\}$ is the familiar symmetric random walk on $\mathbb{Z}$. Let $W(m,n) = \mathbb{P}(X_N = m)$. It is easy to see that

$$W(m,n) = {N \choose (N&#43;m)/2} \left( \frac{1}{2} \right)^N$$
and that the mean and std are

$$\mathbb{E}[X_N] = 0, \quad \sigma^2_{X_N} = N$$Diffusion Coefficient

Definition 6.2: (Diffusion coefficient). The diffusion coefficient $D$ is defined as
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://hasithv.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "6.1 - The Diffusion Limit of Random Walks",
      "item": "https://hasithv.github.io/posts/eliasa/chap6/6-1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "6.1 - The Diffusion Limit of Random Walks",
  "name": "6.1 - The Diffusion Limit of Random Walks",
  "description": "Random Walk Let $\\{\\xi_i\\}$ be i.i.d. random variables such that $\\xi_i = \\pm 1$ with probability $1/2$. Then, define $$X_n = \\sum_{k=1}^{n} \\xi_k, \\quad X_0 = 0.$$ $\\{X_n\\}$ is the familiar symmetric random walk on $\\mathbb{Z}$. Let $W(m,n) = \\mathbb{P}(X_N = m)$. It is easy to see that $$W(m,n) = {N \\choose (N+m)/2} \\left( \\frac{1}{2} \\right)^N$$ and that the mean and std are $$\\mathbb{E}[X_N] = 0, \\quad \\sigma^2_{X_N} = N$$Diffusion Coefficient Definition 6.2: (Diffusion coefficient). The diffusion coefficient $D$ is defined as ",
  "keywords": [
    "stochastics", "lecture"
  ],
  "articleBody": "Random Walk Let $\\{\\xi_i\\}$ be i.i.d. random variables such that $\\xi_i = \\pm 1$ with probability $1/2$. Then, define $$X_n = \\sum_{k=1}^{n} \\xi_k, \\quad X_0 = 0.$$ $\\{X_n\\}$ is the familiar symmetric random walk on $\\mathbb{Z}$. Let $W(m,n) = \\mathbb{P}(X_N = m)$. It is easy to see that $$W(m,n) = {N \\choose (N+m)/2} \\left( \\frac{1}{2} \\right)^N$$ and that the mean and std are $$\\mathbb{E}[X_N] = 0, \\quad \\sigma^2_{X_N} = N$$Diffusion Coefficient Definition 6.2: (Diffusion coefficient). The diffusion coefficient $D$ is defined as $$D = \\frac{\\langle (X_N - X_0)^2 \\rangle}{2N}$$ And for a general stochastic process it is $$D = \\lim_{t \\rightarrow \\infty} \\frac{\\langle (X_t - X_0)^2 \\rangle}{2dt}$$ where $d$ is the space dimension.\nIntuitively, the diffusion coefficient tells us the rate at which variance changes [1]. For the random walk, $D = 1/2$.\nContinuum limit of the random walk Let’s define the step length of the random walk to be $l$ and the timestep to be $\\tau$. Now, fixing $(x,t)$ consider the following limit: $$N,m \\rightarrow \\infty, \\quad l,\\tau \\rightarrow 0, \\quad N\\tau = t, \\quad ml=x$$The diffusion coefficient is then computed as (with $d=1$) $$\\begin{align} D \u0026= \\lim_{t \\rightarrow \\infty} \\frac{\\langle (X_t - X_0)^2 \\rangle}{2t} \\\\ \u0026= \\lim_{t \\rightarrow \\infty} \\frac{\\langle (X_{N\\tau} - X_0)^2 \\rangle}{2N\\tau} \\\\ \u0026= \\lim_{t \\rightarrow \\infty} \\frac{\\langle X_{N\\tau}^2 \\rangle}{2N\\tau} \\\\ \u0026= \\lim_{t \\rightarrow \\infty} \\frac{N l^2}{2N\\tau} \\\\ \u0026= \\frac{l^2}{2\\tau} \\\\ \\end{align}$$ ⚠️ the book mentions “fixing” the diffusion constant, is that different from the computation above?\nWhen we are taking the continuum limit of the random walk, $N, m \\gg 1$, and so $m/N = (x/l) (\\tau/t) = (x/t) (\\tau/l) \\rightarrow 0$. Thus, $m \\ll N$. Now, we can expand $W(m,N)$ using Stirlings formula $\\log n! = (n+\\frac{1}{2})\\log n - n + \\frac{1}{2} \\log 2\\pi + O(n^{-1})$ when $n \\gg 1$ $$\\begin{align} W(m,N) \u0026= \\frac{N!}{\\left(\\frac{N+m}{2}\\right)! \\left(\\frac{N-m}{2}\\right)!} \\left(\\frac{1}{2}\\right)^N \\\\ \\log W(m,n) \u0026= \\log \\left( \\frac{N!}{\\left(\\frac{N+m}{2}\\right)! \\left(\\frac{N-m}{2}\\right)!} \\left(\\frac{1}{2}\\right)^N \\right) \\\\ \u0026\\approx \\log N! - N\\log 2 - \\left(\\log\\left(\\frac{N + m}{2}\\right)! + \\log\\left(\\frac{N-m}{2}\\right)! \\right) \\\\ \u0026\\approx \\left(N+\\frac{1}{2}\\right)\\log N - N + \\frac{1}{2}\\log 2\\pi - N\\log 2 \\\\ \u0026 \\quad \\quad - \\left(\\log\\left(\\frac{N + m}{2}\\right)! + \\log\\left(\\frac{N-m}{2}\\right)! \\right) \\\\ \u0026\\approx \\left(N+\\frac{1}{2}\\right)\\log N - N + \\frac{1}{2}\\log 2\\pi - N\\log 2 \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N + m + 1 \\right) \\log \\left(\\frac{N+m}{2}\\right) + \\frac{N+m}{2} - \\frac{1}{2}\\log 2\\pi \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N - m + 1 \\right) \\log \\left(\\frac{N-m}{2}\\right) + \\frac{N-m}{2} - \\frac{1}{2}\\log 2\\pi \\\\ \u0026\\approx \\left(N+\\frac{1}{2}\\right)\\log N \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N + m + 1 \\right) \\log \\left( \\frac{N}{2}\\left(1+\\frac{m}{N}\\right)\\right) \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N - m + 1 \\right) \\log \\left(\\frac{N}{2}\\left( 1 - \\frac{m}{N} \\right)\\right) \\\\ \u0026 \\quad \\quad -\\frac{1}{2}\\log 2\\pi - N\\log 2 \\end{align}$$ And now using that $m \\ll N$ and $\\log(1+x) \\approx x - \\frac{1}{2}x^2$ for $x \\ll 1$, we have $$\\begin{align} \\log W(m,N) \u0026\\approx \\left(N+\\frac{1}{2}\\right) \\log N - (N+1) \\log\\left(\\frac{N}{2}\\right) \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N + m + 1 \\right) \\log \\left(1+\\frac{m}{N}\\right) \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N - m + 1 \\right) \\log \\left( 1 - \\frac{m}{N} \\right)\\\\ \u0026 \\quad \\quad -\\frac{1}{2}\\log 2\\pi - N\\log 2 \\\\ \u0026\\approx -\\frac{1}{2} \\log N + \\log(2) - \\frac{1}{2}\\log 2\\pi \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N + m + 1 \\right) \\log \\left(1+\\frac{m}{N}\\right) \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N - m + 1 \\right) \\log \\left( 1 - \\frac{m}{N} \\right) \\\\ \u0026\\approx -\\frac{1}{2} \\log N + \\log(2) - \\frac{1}{2}\\log 2\\pi \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N + m + 1 \\right) \\left( \\frac{m}{N} - \\frac{1}{2}\\left(\\frac{m}{N}\\right)^2\\right) \\\\ \u0026 \\quad \\quad - \\frac{1}{2} \\left( N - m + 1 \\right) \\left( -\\frac{m}{N} - \\frac{1}{2}\\left(\\frac{m}{N}\\right)^2\\right) \\\\ \u0026\\approx -\\frac{1}{2} \\log N + \\log(2) - \\frac{1}{2}\\log 2\\pi - \\frac{m^2}{2N} \\\\ \\end{align}$$ $$\\implies W(m,N) \\approx \\left( \\frac{2}{\\pi N} \\right)^{1/2}\\exp\\left(-\\frac{m^2}{2N}\\right) $$ If we integrate across the possible $x$ values, $$\\begin{align} W(x,t)\\Delta x \u0026\\approx \\int_{x-\\Delta/2}^{x+\\Delta/2} W(y, t) dy \\\\ \u0026\\approx \\sum_{\\substack{k = \\{m, m \\pm 2, m \\pm 4, \\ldots\\} \\\\ kl \\in (x-\\Delta x/2, x+\\Delta x/2)}} W(k,N) \\\\ \u0026\\approx W(m,N)\\frac{\\Delta x}{2m} \\end{align}$$ Where $x=ml$. Then, doing some substitions, we get $$W(x,t) = \\frac{1}{\\sqrt{4\\pi D t} } \\exp\\left(-\\frac{x^2}{4Dt}\\right)$$ It is interesting to see that $W$ satisfies the heat equation with the initial condition $$\\begin{cases} \\frac{\\partial W(x,t)}{\\partial t} = D \\frac{\\partial^2 W(x,t)}{\\partial t^2} \\\\ W(x,0) = \\delta(x) \\end{cases}$$ I wonder how it satisfies the boundary condition of maintaining a constant area under the graph for all time $t$.\nArcsine Law Define $P_{2k,2n}$ to be the probability that a particle remains positive for $2k$ time steps before $2n$ time steps have passed. And a particle is on the positive side in an interval $[n-1,n]$ if either $X_{n-1}$ or $X_{n}$ are positive. It is true that $$P_{2k,2n} = u_{2k}u_{2n-2k}$$ where $u_{2k} = \\mathbb{P}(X_{2k} = 0)$ (⚠️ the proof is non-trivial, and not too instructive so it is omitted. Though, if there is an intuitive reason, I’d like to hear it) [2]. Now, let $\\gamma(2n)$ be the number of time units that the particle spends on the positive axis in the interval $[0,2n]$. Then when $x \\leq 1$, $$\\mathbb{P}\\left(\\frac{1}{2} \u003c \\frac{\\gamma (2n)}{2n} \\leq x \\right) = \\sum_{k,1/2\u003c2k/2n\\leq x} P_{2k,2n}$$ From the expression of $W(m,N)$, $$u_{2k} \\sim \\frac{1}{\\sqrt{\\pi k}}, \\quad P_{2k,2n} \\sim \\frac{1}{\\pi \\sqrt{k(n-k)}}$$ as $k, n-k \\rightarrow \\infty$. And so, $$\\begin{align} \\mathbb{P}\\left(\\frac{1}{2} \u003c \\frac{\\gamma (2n)}{2n} \\leq x \\right) \u0026= \\sum_{k,1/2\u003c2k/2n\\leq x} P_{2k,2n} \\\\ \u0026= \\sum_{k,1/2\u003c2k/2n\\leq x} \\frac{1}{\\pi n \\sqrt{(k/n)(1-k/n)}} \\\\ \u0026\\rightarrow \\frac{1}{\\pi} \\int_\\frac{1}{2}^x \\frac{dt}{\\sqrt{t(1-t)}} \\end{align}$$Which leads us to\nTheorem 6.3: (Arcsine law). The probability that the fraction of time spenty by a particle ont he positive side is at most $x$ tends to $\\frac{2}{\\pi}\\arcsin \\sqrt{x}$: $$ \\mathbb{P}\\left(\\frac{\\gamma (2n)}{2n} \\leq x \\right) = \\frac{2}{\\pi} \\arcsin \\sqrt{x} $$ The consequence of this theorem is that it is most likely for a radnom walk to spend either almost all of its time on the positive side, or for it to spend almost no time on the positive side.\nWe can do this because there was no reason to limit the lower bound to $1/2$ rather than $0$ in the derivation\nReferences Helena (https://physics.stackexchange.com/users/12948/helena), What is the physical meaning of diffusion coefficient?, URL (version: 2014-12-03): https://physics.stackexchange.com/q/52977https://physics.stackexchange.com/a/52977/250863 Ackelsberg, Ethan (https://math.osu.edu/sites/math.osu.edu/files/What_is_2018_Arcsine_Law.pdf), What is the Arcsine Law?, URL (version: 2024-08-11): https://math.osu.edu/sites/math.osu.edu/files/What_is_2018_Arcsine_Law.pdf ",
  "wordCount" : "1029",
  "inLanguage": "en",
  "datePublished": "2024-08-10T15:41:44-07:00",
  "dateModified": "2024-08-10T15:41:44-07:00",
  "author":{
    "@type": "Person",
    "name": "Hasith Vattikuti"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hasithv.github.io/posts/eliasa/chap6/6-1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "HasithAlted",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hasithv.github.io/favicon.ico"
    }
  }
}
</script>
    
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$','$']]                  
    }
  };
</script>


    
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hasithv.github.io/" accesskey="h" title="HasithAlted (Alt + H)">HasithAlted</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hasithv.github.io/archives/" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="https://hasithv.github.io/categories/notes/" title="notes">
                    <span>notes</span>
                </a>
            </li>
            <li>
                <a href="https://hasithv.github.io/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://hasithv.github.io/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      6.1 - The Diffusion Limit of Random Walks
    </h1>
    <div class="post-meta"><span title='2024-08-10 15:41:44 -0700 -0700'>August 10, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Hasith Vattikuti

</div>
  </header> 
  <div class="post-content"><h2 id="random-walk">Random Walk<a hidden class="anchor" aria-hidden="true" href="#random-walk">#</a></h2>
<p>Let $\{\xi_i\}$ be i.i.d. random variables such that $\xi_i = \pm 1$ with probability $1/2$. Then, define
</p>
$$X_n = \sum_{k=1}^{n} \xi_k, \quad X_0 = 0.$$<p>
$\{X_n\}$ is the familiar symmetric random walk on $\mathbb{Z}$. Let $W(m,n) = \mathbb{P}(X_N = m)$. It is easy to see that
</p>
$$W(m,n) = {N \choose (N+m)/2} \left( \frac{1}{2} \right)^N$$<p>
and that the mean and std are
</p>
$$\mathbb{E}[X_N] = 0, \quad \sigma^2_{X_N} = N$$<h2 id="diffusion-coefficient">Diffusion Coefficient<a hidden class="anchor" aria-hidden="true" href="#diffusion-coefficient">#</a></h2>
<blockquote>
<p><strong>Definition 6.2:</strong> <em>(Diffusion coefficient)</em>. The diffusion coefficient $D$ is defined as
</p>
$$D = \frac{\langle (X_N - X_0)^2 \rangle}{2N}$$<p>
And for a general stochastic process it is
</p>
$$D = \lim_{t \rightarrow \infty} \frac{\langle (X_t - X_0)^2 \rangle}{2dt}$$<p>
where $d$ is the space dimension.</p></blockquote>
<p>Intuitively, the diffusion coefficient tells us the rate at which variance changes [<a href="https://physics.stackexchange.com/a/52977/250863">1</a>]. For the random walk, $D = 1/2$.</p>
<h2 id="continuum-limit-of-the-random-walk">Continuum limit of the random walk<a hidden class="anchor" aria-hidden="true" href="#continuum-limit-of-the-random-walk">#</a></h2>
<p>Let&rsquo;s define the step length of the random walk to be $l$ and the timestep to be $\tau$. Now, fixing $(x,t)$ consider the following limit:
</p>
$$N,m \rightarrow \infty, \quad l,\tau \rightarrow 0, \quad N\tau = t, \quad ml=x$$<p>The diffusion coefficient is then computed as (with $d=1$)
</p>
$$\begin{align} 
D &= \lim_{t \rightarrow \infty}  \frac{\langle (X_t - X_0)^2 \rangle}{2t} \\
&= \lim_{t \rightarrow \infty}  \frac{\langle (X_{N\tau} - X_0)^2 \rangle}{2N\tau} \\
&= \lim_{t \rightarrow \infty}  \frac{\langle X_{N\tau}^2 \rangle}{2N\tau} \\
&= \lim_{t \rightarrow \infty}  \frac{N l^2}{2N\tau} \\
&= \frac{l^2}{2\tau} \\
\end{align}$$<p>
&#x26a0;&#xfe0f; the book mentions &ldquo;fixing&rdquo; the diffusion constant, is that different from the computation above?</p>
<p>When we are taking the continuum limit of the random walk, $N, m \gg 1$, and so $m/N = (x/l) (\tau/t) = (x/t) (\tau/l) \rightarrow 0$. Thus, $m \ll N$. Now, we can expand $W(m,N)$ using Stirlings formula $\log n! = (n+\frac{1}{2})\log n - n + \frac{1}{2} \log 2\pi + O(n^{-1})$ when $n \gg 1$
</p>
$$\begin{align}
W(m,N) &= \frac{N!}{\left(\frac{N+m}{2}\right)! \left(\frac{N-m}{2}\right)!} \left(\frac{1}{2}\right)^N \\
\log W(m,n) &= \log \left( \frac{N!}{\left(\frac{N+m}{2}\right)! \left(\frac{N-m}{2}\right)!} \left(\frac{1}{2}\right)^N \right) \\
&\approx \log N! - N\log 2 - \left(\log\left(\frac{N + m}{2}\right)! + \log\left(\frac{N-m}{2}\right)! \right) \\
&\approx \left(N+\frac{1}{2}\right)\log N - N + \frac{1}{2}\log 2\pi - N\log 2 \\ 
& \quad \quad - \left(\log\left(\frac{N + m}{2}\right)! + \log\left(\frac{N-m}{2}\right)! \right) \\
&\approx \left(N+\frac{1}{2}\right)\log N - N + \frac{1}{2}\log 2\pi - N\log 2 \\ 
& \quad \quad - \frac{1}{2} \left( N + m + 1 \right) \log \left(\frac{N+m}{2}\right) + \frac{N+m}{2} - \frac{1}{2}\log 2\pi \\
& \quad \quad - \frac{1}{2} \left( N - m + 1 \right) \log \left(\frac{N-m}{2}\right) + \frac{N-m}{2} - \frac{1}{2}\log 2\pi \\
&\approx \left(N+\frac{1}{2}\right)\log N \\ 
& \quad \quad - \frac{1}{2} \left( N + m + 1 \right) \log \left( \frac{N}{2}\left(1+\frac{m}{N}\right)\right) \\
& \quad \quad - \frac{1}{2} \left( N - m + 1 \right) \log \left(\frac{N}{2}\left( 1 - \frac{m}{N} \right)\right) \\
& \quad \quad -\frac{1}{2}\log 2\pi - N\log 2
\end{align}$$<p>
And now using that $m \ll N$ and $\log(1+x) \approx x - \frac{1}{2}x^2$ for $x \ll 1$, we have
</p>
$$\begin{align}
\log W(m,N) &\approx \left(N+\frac{1}{2}\right) \log N - (N+1) \log\left(\frac{N}{2}\right) \\
& \quad \quad - \frac{1}{2} \left( N + m + 1 \right) \log \left(1+\frac{m}{N}\right) \\
& \quad \quad - \frac{1}{2} \left( N - m + 1 \right) \log \left( 1 - \frac{m}{N} \right)\\
& \quad \quad -\frac{1}{2}\log 2\pi - N\log 2 \\
&\approx -\frac{1}{2} \log N + \log(2) - \frac{1}{2}\log 2\pi \\
& \quad \quad - \frac{1}{2} \left( N + m + 1 \right) \log \left(1+\frac{m}{N}\right) \\
& \quad \quad - \frac{1}{2} \left( N - m + 1 \right) \log \left( 1 - \frac{m}{N} \right) \\
&\approx -\frac{1}{2} \log N + \log(2) - \frac{1}{2}\log 2\pi \\
& \quad \quad - \frac{1}{2} \left( N + m + 1 \right) \left( \frac{m}{N} - \frac{1}{2}\left(\frac{m}{N}\right)^2\right) \\
& \quad \quad - \frac{1}{2} \left( N - m + 1 \right) \left( -\frac{m}{N} - \frac{1}{2}\left(\frac{m}{N}\right)^2\right) \\
&\approx -\frac{1}{2} \log N + \log(2) - \frac{1}{2}\log 2\pi - \frac{m^2}{2N} \\
\end{align}$$<p>
</p>
$$\implies  W(m,N) \approx \left( \frac{2}{\pi N} \right)^{1/2}\exp\left(-\frac{m^2}{2N}\right) $$<p>
If we integrate across the possible $x$ values,
</p>
$$\begin{align}
W(x,t)\Delta x &\approx \int_{x-\Delta/2}^{x+\Delta/2} W(y, t) dy \\
&\approx \sum_{\substack{k = \{m, m \pm 2, m \pm 4, \ldots\} \\ kl \in (x-\Delta x/2, x+\Delta x/2)}} W(k,N) \\
&\approx W(m,N)\frac{\Delta x}{2m}
\end{align}$$<p>
Where $x=ml$. Then, doing some substitions, we get
</p>
$$W(x,t) = \frac{1}{\sqrt{4\pi D t} } \exp\left(-\frac{x^2}{4Dt}\right)$$<p>
It is interesting to see that $W$ satisfies the heat equation with the initial condition
</p>
$$\begin{cases}
    \frac{\partial W(x,t)}{\partial t} = D \frac{\partial^2 W(x,t)}{\partial t^2} \\
    W(x,0) = \delta(x)
\end{cases}$$<p>
I wonder how it satisfies the boundary condition of maintaining a constant area under the graph for all time $t$.</p>
<h2 id="arcsine-law">Arcsine Law<a hidden class="anchor" aria-hidden="true" href="#arcsine-law">#</a></h2>
<p>Define $P_{2k,2n}$ to be the probability that a particle remains positive for $2k$ time steps before $2n$ time steps have passed. And a particle is on the positive side in an interval $[n-1,n]$ if either $X_{n-1}$ or $X_{n}$ are positive. It is true that
</p>
$$P_{2k,2n} = u_{2k}u_{2n-2k}$$<p>
where $u_{2k} = \mathbb{P}(X_{2k} = 0)$ (&#x26a0;&#xfe0f; the proof is non-trivial, and not too instructive so it is omitted. Though, if there is an intuitive reason, I&rsquo;d like to hear it) [<a href="https://math.osu.edu/sites/math.osu.edu/files/What_is_2018_Arcsine_Law.pdf">2</a>]. Now, let $\gamma(2n)$ be the number of time units that the particle spends on the positive axis in the interval $[0,2n]$. Then when $x \leq 1$,
</p>
$$\mathbb{P}\left(\frac{1}{2} < \frac{\gamma (2n)}{2n} \leq x \right) = \sum_{k,1/2<2k/2n\leq x} P_{2k,2n}$$<p>
From the expression of $W(m,N)$,
</p>
$$u_{2k} \sim \frac{1}{\sqrt{\pi k}}, \quad P_{2k,2n} \sim \frac{1}{\pi \sqrt{k(n-k)}}$$<p>
as $k, n-k \rightarrow \infty$. And so,
</p>
$$\begin{align}
\mathbb{P}\left(\frac{1}{2} < \frac{\gamma (2n)}{2n} \leq x \right) &= \sum_{k,1/2<2k/2n\leq x} P_{2k,2n} \\
&= \sum_{k,1/2<2k/2n\leq x}  \frac{1}{\pi n \sqrt{(k/n)(1-k/n)}} \\
&\rightarrow \frac{1}{\pi} \int_\frac{1}{2}^x \frac{dt}{\sqrt{t(1-t)}}
\end{align}$$<p>Which leads us to</p>
<blockquote>
<p><strong>Theorem 6.3:</strong> <em>(Arcsine law).</em> The probability that the fraction of time spenty by a particle ont he positive side is at most $x$ tends to $\frac{2}{\pi}\arcsin \sqrt{x}$:
</p>
$$ \mathbb{P}\left(\frac{\gamma (2n)}{2n} \leq x \right) = \frac{2}{\pi} \arcsin \sqrt{x} $$<p>
The consequence of this theorem is that it is most likely for a radnom walk to spend either almost all of its time on the positive side, or for it to spend almost no time on the positive side.</p>
<p>We can do this because there was no reason to limit the lower bound to $1/2$ rather than $0$ in the derivation</p></blockquote>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ol>
<li>Helena (<a href="https://physics.stackexchange.com/users/12948/helena)">https://physics.stackexchange.com/users/12948/helena)</a>, What is the physical meaning of diffusion coefficient?, URL (version: 2014-12-03): <a href="https://physics.stackexchange.com/q/52977https://physics.stackexchange.com/a/52977/250863">https://physics.stackexchange.com/q/52977https://physics.stackexchange.com/a/52977/250863</a></li>
<li>Ackelsberg, Ethan (<a href="https://math.osu.edu/sites/math.osu.edu/files/What_is_2018_Arcsine_Law.pdf)">https://math.osu.edu/sites/math.osu.edu/files/What_is_2018_Arcsine_Law.pdf)</a>, What is the Arcsine Law?, URL (version: 2024-08-11): <a href="https://math.osu.edu/sites/math.osu.edu/files/What_is_2018_Arcsine_Law.pdf">https://math.osu.edu/sites/math.osu.edu/files/What_is_2018_Arcsine_Law.pdf</a></li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://hasithv.github.io/tags/stochastics/">Stochastics</a></li>
      <li><a href="https://hasithv.github.io/tags/lecture/">Lecture</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://hasithv.github.io/">HasithAlted</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
